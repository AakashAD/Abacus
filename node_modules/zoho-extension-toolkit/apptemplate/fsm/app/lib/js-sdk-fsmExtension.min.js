var ZSDKUtil=function(e){var t,n=o();function r(e){}function o(e){var n={};return(e=e||window.location.href).substr(e.indexOf("?")+1).split("&").forEach(function(e,t){e=e.split("=");n[e[0]]=e[1]}),n.hasOwnProperty("serviceOrigin")&&(n.serviceOrigin=decodeURIComponent(n.serviceOrigin)),n}return r.prototype.Info=function(){(e.isDevMode()||e.isLogEnabled())&&window.console.info.apply(null,arguments)},r.prototype.Error=function(){(e.isDevMode()||e.isLogEnabled())&&window.console.error.apply(null,arguments)},e.GetQueryParams=o,e.isDevMode=function(){return n&&n.isDevMode},e.isLogEnabled=function(){return n&&n.isLogEnabled},e.getLogger=function(){return t=t&&t instanceof r?t:new r},e.Sleep=function(e){var t=(new Date).getTime();for(loopTime=t;t+e>(new Date).getTime();)loopTime++},e}(window.ZSDKUtil||{}),ZSDKMessageManager=function(n){var o,i,u,E=ZSDKUtil.getLogger(),e=100,r={};new RegExp("^https?://[a-zA-Z0-9-_]*.(sandbox.crm-oem.com|csez.zohocorpin.com|zoho.com|zoho.eu|zohoplatform.com|zohosandbox.com)(:[0-9]{0,4})?$");function a(e,t){e.origin;i=window.parent,u=o.QueryParams.serviceOrigin,o.SetContext(t.data),o.ExecuteLoadHandler()}function c(e,t){}function S(e,t){f(t.promiseid,!0,t.data)}function s(e,t){f(t.promiseid,!1,t.data)}function f(e,t,n){r.hasOwnProperty(e)&&(t?r[e].resolve(n):r[e].reject(n),r[e]=void 0,delete r[e])}function O(){return"Promise"+e++}function d(n){return new Promise(function(e,t){r[n]={resolve:e,reject:t,time:(new Date).getTime()}})}function D(e){if("object"==typeof e&&(e.appOrigin=encodeURIComponent(t())),!i)throw new Error("Parentwindow reference not found.");i.postMessage(e,o.QueryParams.serviceOrigin)}function t(){return window.location.protocol+"//"+window.location.host+window.location.pathname}return n.Init=function(e,t){if(!e||"object"!=typeof e)throw Error("Invalid Context object passed");if(t&&"object"!=typeof t)throw Error("Invalid Configuration Passed to MessageManager");return o=e,function(t){try{var n="string"==typeof t.data?JSON.parse(t.data):t.data}catch(e){n=t.data}var e=n.type,r=n.eventName;try{"SET_CONTEXT"!==r&&!function(e){var t=e.source,e=e.origin;if(o.isAppRegistered()&&i===t&&u===e)return 1;return new Error("Un-Authorized Message.")}(t)||("FRAMEWORK.EVENT"===e?function(e,t){t.data;var n={SET_CONTEXT:a,UPDATE_CONTEXT:c,EVENT_RESPONSE:S,EVENT_RESPONSE_FAILURE:s}[t.eventName];n&&"function"==typeof n?n(e,t):function(e){ZSDKEventManager.NotifyEventListeners(o.AppContext,e.eventName,e.data)}(t)}(t,n):o.MessageInterceptor(t,n))}catch(e){E.Error("[SDK.MessageHandler] => ",e.stack)}}.bind(n)},n.RegisterApp=function(){var e={type:"SDK.EVENT",eventName:"REGISTER",appOrigin:encodeURIComponent(t())};window.parent.postMessage(e,o.QueryParams.serviceOrigin)},n.DERegisterApp=function(){D({type:"SDK.EVENT",eventName:"DEREGISTER",uniqueID:o.getUniqueID()})},n.SendRequest=function(e){if(e&&"object"==typeof e){var t,n="HTTP_REQUEST",r=!0;if(n)return t=r?O():void 0,D({type:"SDK.EVENT",eventName:n,uniqueID:o.getUniqueID(),time:(new Date).getTime(),promiseid:t,data:e}),r?d(t):void 0;throw new Error("Invalid Eventname : ",n)}throw new Error("Invalid Options passed")},n.TriggerEvent=function(e,t,n){if(!e)throw new Error("Invalid Eventname : ",e);var r=n?O():void 0;if(D({type:"SDK.EVENT",eventName:e,uniqueID:o.getUniqueID(),time:(new Date).getTime(),promiseid:r,data:t}),n)return d(r)},n}(window.ZSDKMessageManager||{}),ZSDKEventManager=function(e){var u=ZSDKUtil.getLogger(),E={};return e.AttachEventListener=function(e,t){"function"==typeof t&&(Array.isArray(E[e])||(E[e]=[]),E[e].push(t))},e.NotifyEventListeners=function(e,t,n){var r=t.match(/^\__[A-Za-z_]+\__$/gi),o=(Array.isArray(r)&&r.length,E[t]);if(o&&Array.isArray(o))for(var i=0;i<o.length;i++)o[i].call(e,n);else u.Info("Cannot find EventListeners for Event : ",t)},e.NotifyInternalEventHandler=function(e,t){var n=t.eventName;"__APP_INIT__"===n?(e.SetContext(t.data),e.ExecuteLoadHandler()):"__APP_CONTEXT_UPDATE__"===n&&(e.UpdateContext(t.data),e.ExecuteContextUpdateHandler())},e}(window.ZSDKEventManager||{});function ZSDK(){var t,n,u,E,e,r,a={},c=ZSDKUtil.getLogger(),S=!1,o=!1,s=(this.isContextReady=!1,this.HelperContext={},this.isDevMode=!1,this.getContext=function(){return s},{});function i(){"function"!=typeof t?c.Error("No OnLoad Handler provided to execute."):o?c.Error("OnLoad event already triggered."):(t.call(s,s),o=!0)}function f(){n.call(s,s)}function O(){return S}function d(e,t,n){return ZSDKMessageManager.TriggerEvent(e,t,n)}function D(e){c.Info("Setting AppContext data");var t,n,r,o=e&&e.model||{};e&&e.locale,e&&e.localeResource;if(isDevMode&&e.locale&&e.localeResource&&0===Object.keys(e.localeResource).length&&e.localeResource.constructor===Object&&e.locale&&(t="/app-translations/"+e.locale+".json",n=function(e){a=JSON.parse(e);var t,n,r=document.querySelectorAll("[data-i18n]");for(t in r)if(r.hasOwnProperty(t)){var o=A(a,r[t].getAttribute("data-i18n"));if(!o)return;if(r[t].hasAttribute("data-options")){var i=Object.keys(void 0);for(n in i)o=l(o,"${"+i[n]+"}",(void 0)[i[n]])}r[t].innerHTML=o}},(r=new XMLHttpRequest).open("GET",t,!1),r.onreadystatechange=function(){4==r.readyState&&"200"==r.status&&n(r.responseText)},r.send(null)),"undefined"!=typeof ZSDKModelManager){for(var i in o)ZSDKModelManager.AddModel(i,o[i]);s.Model=ZSDKModelManager.GetModelStore()}E=e.uniqueID,u=e.connectors,c.Info("App Connectors ",u),S=!0}function M(){return E}function T(e){}function R(){return u}function l(e,t,n){for(var r="";r!=e;)e=(r=e).replace(t,n);return e}function A(e,t){for(var n=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),r=0,o=n.length;r<o;++r){var i=n[r];if(!(i in e))return;e=e[i]}return e}s.Model={},s.Event={},s.Event.Listen=function(e,t){ZSDKEventManager.AttachEventListener(e,t)},s.Event.Trigger=d,s.GetRequest=function(e){return ZSDKMessageManager.SendRequest(e)},s.QueryParams=r,s.Translate=function(e,t){var n="";e&&(n=A(a,e));if(!n)return!1;if(t){var r=Object.keys(void 0);for(e in r)n=l(n,"${"+r[e]+"}",(void 0)[r[e]])}return n},this.OnLoad=function(e){if("function"!=typeof e)throw new Error("Invalid Function value is passed");t=e,S&&i()},this.OnUnLoad=function(e){},this.OnContextUpdate=function(e){n=e},r=ZSDKUtil.GetQueryParams(),isDevMode=!!r.isDevMode,(e={}).isDevMode=isDevMode,e.ExecuteLoadHandler=i,e.SetContext=D,e.UpdateContext=T,e.QueryParams=r,e.GetConnectors=R,e.TriggerEvent=d,e.ExecuteContextUpdateHandler=f,e.getUniqueID=M,e.isAppRegistered=O,r=ZSDKMessageManager.Init(e),window.addEventListener("message",r),window.addEventListener("unload",function(){ZSDKMessageManager.DERegisterApp()}),"undefined"!=typeof ZSDKModelManager&&ZSDKModelManager.Init(e),ZSDKMessageManager.RegisterApp()}var ZOHO=function(){var t,r={},o=!1,i=void 0,n={MODULES:{REQUESTS:"Requests",WORK_ORDER:"Work_Orders",SERVICE_APPOINTMENT:"Service_Appointments",ESTIMATE:"Estimates",CONTACT:"Contacts",COMPANIES:"Accounts",ASSETS:"Assets",SERVICES_AND_PARTS:"Products"}};return{embeddedApp:{on:function(e,t){r[e]=t},init:function(){var n,e;if(!o)for(e in o=!0,t=new ZSDK,i=new Promise(function(e,t){n=e}),t.OnLoad(function(){n()}),r)t.getContext().Event.Listen(e,r[e]);return i}},FSM:{REQUEST:{API:{create:function(e){return E(n.MODULES.REQUESTS,e)},list:function(e){return S(n.MODULES.REQUESTS,e)},get:function(e){return a(n.MODULES.REQUESTS,e)},update:function(e){if(e.id)return c(n.MODULES.REQUESTS,e)},getRelatedRecords:function(e,t){return d(n.MODULES.REQUESTS,e,t)}},META:{getFields:function(){return e(n.MODULES.REQUESTS)},getRelatedLists:function(){return s(n.MODULES.REQUESTS)},listLayouts:function(){return f(n.MODULES.REQUESTS)},getLayout:function(e,t){return f(n.MODULES.REQUESTS,e,t)}},ACTION:{convertToWorkOrder:function(e){return E(n.MODULES.WORK_ORDER,e)},convertToEstimate:function(e){return E(n.MODULES.ESTIMATE,e)},cancel:function(e,t){return O(n.MODULES.REQUESTS,e,"Cancelled",{Notes:t})},terminate:function(e,t){return O(n.MODULES.REQUESTS,e,"Cannot Complete",{Notes:t})}}},WORK_ORDER:{API:{create:function(e){return E(n.MODULES.WORK_ORDER,e)},list:function(e){return S(n.MODULES.WORK_ORDER,e)},get:function(e){return a(n.MODULES.WORK_ORDER,e)},update:function(e){return c(n.MODULES.WORK_ORDER,e)},getRelatedRecords:function(e,t){return d(n.MODULES.WORK_ORDER,e,t)}},META:{getFields:function(){return e(n.MODULES.WORK_ORDER)},getRelatedLists:function(){return s(n.MODULES.WORK_ORDER)},listLayouts:function(){return f(n.MODULES.WORK_ORDER)},getLayout:function(e,t){return f(n.MODULES.WORK_ORDER,e,t)}},ACTION:{cancel:function(e,t){return O(n.MODULES.WORK_ORDER,e,"Cancelled",{Notes:t})},terminate:function(e,t){return O(n.MODULES.WORK_ORDER,e,"Cannot Complete",{Notes:t})},complete:function(e){return O(n.MODULES.WORK_ORDER,e,"Completed")},close:function(e){return O(n.MODULES.WORK_ORDER,e,"Closed")}}},ESTIMATE:{API:{create:function(e){return E(n.MODULES.ESTIMATE,e)},list:function(e){return S(n.MODULES.ESTIMATE,e)},get:function(e){return a(n.MODULES.ESTIMATE,e)},update:function(e){return c(n.MODULES.ESTIMATE,e)},getRelatedRecords:function(e,t){return d(n.MODULES.ESTIMATE,e,t)}},META:{getFields:function(){return e(n.MODULES.ESTIMATE)},getRelatedLists:function(){return s(n.MODULES.ESTIMATE)},listLayouts:function(){return f(n.MODULES.ESTIMATE)},getLayout:function(e,t){return f(n.MODULES.ESTIMATE,e,t)}},ACTION:{approve:function(e){return O(n.MODULES.ESTIMATE,e,"Approved")},reject:function(e,t){return O(n.MODULES.ESTIMATE,e,"Rejected",{Notes:t})},markAsExpired:function(e){return O(n.MODULES.ESTIMATE,e,"Expired")},cancel:function(e,t){return O(n.MODULES.ESTIMATE,e,"Cancelled",{Notes:t})},terminate:function(e,t){return O(n.MODULES.ESTIMATE,e,"Cannot Complete",{Notes:t})},convertToWorkOrder:function(e){return E(n.MODULES.WORK_ORDER,e)}}},SERVICE_APPOINTMENT:{API:{create:function(e){return E(n.MODULES.SERVICE_APPOINTMENT,e)},list:function(e){return S(n.MODULES.SERVICE_APPOINTMENT,e)},get:function(e){return a(n.MODULES.SERVICE_APPOINTMENT,e)},update:function(e){return c(n.MODULES.SERVICE_APPOINTMENT,e)},getRelatedRecords:function(e,t){return d(n.MODULES.SERVICE_APPOINTMENT,e,t)}},META:{getFields:function(){return e(n.MODULES.SERVICE_APPOINTMENT)},getRelatedLists:function(){return s(n.MODULES.SERVICE_APPOINTMENT)},listLayouts:function(){return f(n.MODULES.SERVICE_APPOINTMENT)},getLayout:function(e,t){return f(n.MODULES.SERVICE_APPOINTMENT,e,t)}},ACTION:{dispatch:function(e){return O(n.MODULES.SERVICE_APPOINTMENT,e,"Dispatched")},startWork:function(e,t){return O(n.MODULES.SERVICE_APPOINTMENT,e,"In Progress",t)},completeWork:function(e,t){return O(n.MODULES.SERVICE_APPOINTMENT,e,"Completed",t)},cancel:function(e,t){return O(n.MODULES.SERVICE_APPOINTMENT,e,"Cancelled",{Notes:t})},terminate:function(e,t){return O(n.MODULES.SERVICE_APPOINTMENT,e,"Cannot Complete",{Notes:t})}}},CONTACT:{API:{create:function(e){return E(n.MODULES.CONTACT,e,{sync:!0})},list:function(e){return S(n.MODULES.CONTACT,e)},get:function(e){return a(n.MODULES.CONTACT,e)},update:function(e){return c(n.MODULES.CONTACT,e)},getRelatedRecords:function(e,t){return d(n.MODULES.CONTACT,e,t)}},META:{getFields:function(){return e(n.MODULES.CONTACT)},getRelatedLists:function(){return s(n.MODULES.CONTACT)},listLayouts:function(){return f(n.MODULES.CONTACT)},getLayout:function(e,t){return f(n.MODULES.CONTACT,e,t)}}},COMPANIES:{API:{create:function(e){return E(n.MODULES.COMPANIES,e,{sync:!0})},list:function(e){return S(n.MODULES.COMPANIES,e)},get:function(e){return a(n.MODULES.COMPANIES,e)},update:function(e){return c(n.MODULES.COMPANIES,e)},getRelatedRecords:function(e,t){return d(n.MODULES.COMPANIES,e,t)}},META:{getFields:function(){return e(n.MODULES.COMPANIES)},getRelatedLists:function(){return s(n.MODULES.COMPANIES)},listLayouts:function(){return f(n.MODULES.COMPANIES)},getLayout:function(e,t){return f(n.MODULES.COMPANIES,e,t)}}},ASSETS:{API:{create:function(e){return E(n.MODULES.ASSETS,e)},list:function(e){return S(n.MODULES.ASSETS,e)},get:function(e){return a(n.MODULES.ASSETS,e)},update:function(e){return c(n.MODULES.ASSETS,e)},getRelatedRecords:function(e,t){return d(n.MODULES.ASSETS,e,t)}},META:{getFields:function(){return e(n.MODULES.ASSETS)},getRelatedLists:function(){return s(n.MODULES.ASSETS)},listLayouts:function(){return f(n.MODULES.ASSETS)},getLayout:function(e,t){return f(n.MODULES.ASSETS,e,t)}}},SERVICES_AND_PARTS:{API:{create:function(e,t){return E(n.MODULES.SERVICES_AND_PARTS,e,{layout:t})},list:function(e){return S(n.MODULES.SERVICES_AND_PARTS,e)},get:function(e){return a(n.MODULES.SERVICES_AND_PARTS,e)},update:function(e,t){return c(n.MODULES.SERVICES_AND_PARTS,e,t)},getRelatedRecords:function(e,t){return d(n.MODULES.SERVICES_AND_PARTS,e,t)}},META:{getFields:function(){return e(n.MODULES.SERVICES_AND_PARTS)},getRelatedLists:function(){return s(n.MODULES.SERVICES_AND_PARTS)},listLayouts:function(){return f(n.MODULES.SERVICES_AND_PARTS)},getLayout:function(e,t){return f(n.MODULES.SERVICES_AND_PARTS,e,t)}}},USERS:{API:{getUsers:function(e){return u({category:"READ",type:"USERS_BY_TYPE",Type:e=e||""})},getCurrentUser:function(){return u({category:"READ",type:"CURRENT_USER"})},getUserByID:function(e){return u({category:"READ",type:"USER",userID:e})},createUser:function(e){return u({category:"CREATE",type:"USER",APIData:e})}}},CONNECTION:{invoke:function(e,t){return u({category:"INVOKE",type:"CONNECTION_API",APIData:t,name:e})}}}};function u(e){return e.sdkVersion="1",t.getContext().Event.Trigger("FSM_EVENT",e,!0)}function E(e,t,n){e={category:"CREATE",Module:e,APIData:t,layout:(n=n||{}).layout,sync:n.sync,type:"RECORD"};return u(e)}function a(e,t){return u({category:"READ",APIData:{Module:e,RecordID:t},type:"RECORD"})}function c(e,t,n){return u({category:"UPDATE",type:"RECORD",Module:e,APIData:t,layout:n})}function S(e,t){return u({category:"READ",type:"RECORD",APIData:{Module:e,options:t}})}function e(e){return u({category:"READ",type:"FIELDS",Module:e})}function s(e){return u({category:"READ",type:"RELATED_LISTS",Module:e})}function f(e,t,n){return u({category:"READ",type:"LAYOUT",Module:e,layout:t,options:n})}function O(e,t,n,r){return u({category:"UPDATE",type:"BLUEPRINT",Module:e,APIData:{RecordID:t,transitionTo:n,transitionData:r}})}function d(e,t,n){return u({category:"READ",type:"RELATED_RECORDS",Module:e,RecordID:t,RelatedListName:n})}}();
//# sourceMappingURL=maps/js-sdk-fsmExtension.min.js.map
